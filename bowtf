local lp = game.Players.LocalPlayer
local saveModule = require(game:GetService("ReplicatedStorage").Library.Client.Save)

local function convertToNumber(str)
    local num = tonumber(str:match("%d+%.?%d*"))
    if str:find("k") then
        num = num * 1000
    elseif str:find("m") then
        num = num * 1000000
    elseif str:find("b") then
        num = num * 1000000000
    end
    return num
end

local function isZoneUnlocked(zoneName)
    local result = saveModule.Get()
    local unlockedZones = result.UnlockedZones or {}
    return unlockedZones[zoneName]
end

local spawn = workspace.Map["1 | Spawn"].INTERACT.BREAK_ZONES.BREAK_ZONE.CFrame

if not isZoneUnlocked("Spawn") then
    repeat task.wait()
        local goldCoinPath = lp.PlayerGui.MainMobile.MobileCurrency.Bottom.Coins["Gold Coins"].Amount.Text
        local goldCoin = convertToNumber(goldCoinPath)
        if not isZoneUnlocked("Spawn") then
            lp.Character.HumanoidRootPart.CFrame = spawn + Vector3.new(0, 5, 0)
        end
    until goldCoin >= 900 or isZoneUnlocked("Spawn")

    while not isZoneUnlocked("Colorful Forest") and task.wait() do
        local goldCoinPath = lp.PlayerGui.MainMobile.MobileCurrency.Bottom.Coins["Gold Coins"].Amount.Text
        local goldCoin = convertToNumber(goldCoinPath)
        if goldCoin >= 900 then
            game:GetService("ReplicatedStorage").Network.Zones_RequestPurchase:InvokeServer("Colorful Forest")
            break
        end
    end
end

local colorful_forest = workspace.Map["2 | Colorful Forest"].INTERACT.BREAK_ZONES.BREAK_ZONE.CFrame

if not isZoneUnlocked("Colorful Forest") then
    repeat task.wait()
        local goldCoinPath = lp.PlayerGui.MainMobile.MobileCurrency.Bottom.Coins["Gold Coins"].Amount.Text
        local goldCoin = convertToNumber(goldCoinPath)
        if not isZoneUnlocked("Colorful Forest") then
            lp.Character.HumanoidRootPart.CFrame = colorful_forest + Vector3.new(0,5,0)
        end
    until goldCoin >= 2500 or isZoneUnlocked("Colorful Forest")

    while not isZoneUnlocked("Castle") and task.wait() do
        local goldCoinPath = lp.PlayerGui.MainMobile.MobileCurrency.Bottom.Coins["Gold Coins"].Amount.Text
        local goldCoin = convertToNumber(goldCoinPath)
        if goldCoin >= 2500 then
            game:GetService("ReplicatedStorage").Network.Zones_RequestPurchase:InvokeServer("Castle")
            break
        end
    end
end

local castle = workspace.Map["3 | Castle"].INTERACT.BREAK_ZONES.BREAK_ZONE.CFrame

if not isZoneUnlocked("Castle") then
    repeat task.wait()
        local goldCoinPath = lp.PlayerGui.MainMobile.MobileCurrency.Bottom.Coins["Gold Coins"].Amount.Text
        local goldCoin = convertToNumber(goldCoinPath)
        if not isZoneUnlocked("Castle") then
            lp.Character.HumanoidRootPart.CFrame = colorful_forest + Vector3.new(0,5,0)
        end
    until goldCoin >= 2500 or isZoneUnlocked("Castle")

    while not isZoneUnlocked("Green Forest") and task.wait() do
        local goldCoinPath = lp.PlayerGui.MainMobile.MobileCurrency.Bottom.Coins["Gold Coins"].Amount.Text
        local goldCoin = convertToNumber(goldCoinPath)
        if goldCoin >= 8000 then
            game:GetService("ReplicatedStorage").Network.Zones_RequestPurchase:InvokeServer("Green Forest")
            break
        end
    end
end

local green_forest = workspace.Map["4 | Green Forest"].INTERACT.BREAK_ZONES.BREAK_ZONE.CFrame

if not isZoneUnlocked("Green Forest") then
    repeat task.wait()
        local goldCoinPath = lp.PlayerGui.MainMobile.MobileCurrency.Bottom.Coins["Gold Coins"].Amount.Text
        local goldCoin = convertToNumber(goldCoinPath)
        if not isZoneUnlocked("Green Forest") then
            lp.Character.HumanoidRootPart.CFrame = colorful_forest + Vector3.new(0,5,0)
        end
    until goldCoin >= 2500 or isZoneUnlocked("Green Forest")

    while not isZoneUnlocked("Autumn") and task.wait() do
        local goldCoinPath = lp.PlayerGui.MainMobile.MobileCurrency.Bottom.Coins["Gold Coins"].Amount.Text
        local goldCoin = convertToNumber(goldCoinPath)
        if goldCoin >= 8000 then
            game:GetService("ReplicatedStorage").Network.Zones_RequestPurchase:InvokeServer("Autumn")
            break
        end
    end
end
